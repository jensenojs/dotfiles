# XDG 基础目录规范 (XDG Base Directory Specification)

XDG 基础目录规范定义了在类 Unix 系统上用户特定文件和配置数据的标准位置，有助于组织和标准化应用程序存储和检索数据的方式。

## 环境变量和默认值

### 用户特定目录

| 变量 | 默认值 | 用途 |
|------|--------|------|
| `$XDG_DATA_HOME` | `$HOME/.local/share` | 用户特定数据文件 |
| `$XDG_CONFIG_HOME` | `$HOME/.config` | 用户特定配置文件 |
| `$XDG_STATE_HOME` | `$HOME/.local/state` | 用户特定状态数据(在应用程序重启之间持久化) |
| `$XDG_CACHE_HOME` | `$HOME/.cache` | 用户特定非必要缓存数据 |
| `$XDG_RUNTIME_DIR` | 系统定义 | 用户特定运行时文件(必须由用户拥有，权限为 0700) |

### 系统目录(搜索路径)

| 变量 | 默认值 | 用途 |
|------|--------|------|
| `$XDG_DATA_DIRS` | `/usr/local/share/:/usr/share/` | 系统数据目录(按优先级顺序) |
| `$XDG_CONFIG_DIRS` | `/etc/xdg` | 系统配置目录(按优先级顺序) |

### 可执行文件

用户特定的可执行文件应放在 `$HOME/.local/bin`，该目录应包含在系统 `$PATH` 中。

## 各变量详解

### `$XDG_DATA_HOME`

- 存储用户特定数据文件
- 默认值: `$HOME/.local/share`
- 如果目录不存在，应用程序应以 0700 权限创建该目录

### `$XDG_CONFIG_HOME`

- 存储用户特定配置文件
- 默认值: `$HOME/.config`
- 被认为比系统配置目录更重要

### `$XDG_STATE_HOME`

- 存储在应用程序重启之间持久化的状态数据，但不是必要的用户数据
- 包括日志、历史记录、最近使用的文件、应用程序布局状态等
- 默认值: `$HOME/.local/state`

### `$XDG_CACHE_HOME`

- 存储非必要的缓存数据，这些数据可以重新生成或再次下载
- 默认值: `$HOME/.cache`

### `$XDG_RUNTIME_DIR`

- 存储运行时文件，如套接字、命名管道和其他临时文件
- 必须由用户拥有，权限为 0700
- 生命周期与用户登录会话绑定(登录时创建，注销时删除)
- 不应在此后重启或完全注销/登录周期中存在
- 如果未设置，应用程序应回退到替代方案并警告用户

### `$XDG_DATA_DIRS` 和 `$XDG_CONFIG_DIRS`

- 定义系统范围数据和配置的搜索路径
- 目录之间用冒号 (:) 分隔(在类 Unix 系统上)
- 列表中的第一个目录最重要
- `$XDG_DATA_HOME` 被认为比 `$XDG_DATA_DIRS` 中的任何目录都重要
- `$XDG_CONFIG_HOME` 被认为比 `$XDG_CONFIG_DIRS` 中的任何目录都重要

## 实现指南

1. **路径要求**: 所有路径必须是绝对路径。相对路径应被视为无效并忽略。

2. **文件创建**: 写入文件时，如果目标目录不存在，应用程序应尝试以 0700 权限创建目录。

3. **错误处理**: 应用程序应优雅地处理无法写入或访问文件的情况。

4. **搜索顺序**: 读取文件时，应用程序应首先在用户目录中搜索，然后按照优先级顺序在系统目录中搜索。

5. **冲突解决**: 当同一文件存在于多个位置时，应优先使用最重要目录中的文件(基于指定的层次结构)。

该规范有助于在不同应用程序和发行版之间创建一致且有组织的文件存储方法，改善用户体验和系统可维护性。
