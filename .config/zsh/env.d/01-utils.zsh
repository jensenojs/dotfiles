# 工具函数库 - Utility Functions
# 提供通用的辅助函数，供其他配置模块使用

# ============================================================================
# 命令和文件检测 - Command & File Detection
# ============================================================================

# 检查命令是否存在
command_exists() {
  command -v "$1" >/dev/null 2>&1
}

# 检查文件是否存在且可读
file_readable() {
  [[ -r "$1" ]]
}

# 检查目录是否存在
dir_exists() {
  [[ -d "$1" ]]
}

# 安全地 source 文件(文件存在且可读时才加载)
source_if_exists() {
  [[ -r "$1" ]] && source "$1"
}

# ============================================================================
# 操作系统检测 - OS Detection
# ============================================================================

# 检查是否为 macOS
is_macos() {
  [[ "$OSTYPE" == darwin* ]]
}

# 检查是否为 Linux
is_linux() {
  [[ "$OSTYPE" == linux* ]]
}

# ============================================================================
# PATH 操作 - PATH Manipulation
# ============================================================================

# 如果目录存在且不在 PATH 中，则添加到 PATH 开头
prepend_to_path_if_exists() {
  [[ -d "$1" ]] && [[ ":$PATH:" != *":$1:"* ]] && export PATH="$1:$PATH"
}

# ============================================================================
# 基础配置 - Basic Configuration
# ============================================================================

# 默认编辑器
export EDITOR="nvim"

# 确保 PATH 中的条目唯一(去重)
typeset -U path
